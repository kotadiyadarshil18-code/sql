CREATE TABLE student (
    studentID INT PRIMARY KEY,
    firstname VARCHAR(50),
    lastname VARCHAR(50),
    email VARCHAR(100),
    birthdate DATE,
    enrollmentdate DATE
);

INSERT INTO student 
(studentID, firstname, lastname, email, birthdate, enrollmentdate) 
VALUES
(1,'John','Deo','john.deo@email.com','2000-01-15','2022-08-01'),
(2,'Jane','Smith','jane.smith@email.com','1999-05-25','2021-08-01');


CREATE TABLE department (
    departmentID INT PRIMARY KEY,
    departmentname VARCHAR(50)
);

INSERT INTO department (departmentID, departmentname) VALUES 
(1,'Computer Science'),
(2,'Mathematics');


CREATE TABLE courses(
    courseid INT PRIMARY KEY,
    coursename VARCHAR(50),
    DepartmentID INT,
    Credits INT,
    FOREIGN KEY (DepartmentID) REFERENCES department(departmentID)
);

INSERT INTO courses (courseid, coursename, DepartmentID, Credits) VALUES
(101,'Introduction to SQL',1,3),
(102,'Data Structures',2,4);


CREATE TABLE instructors (
    InstructorsID INT PRIMARY KEY,
    firstname VARCHAR(50),
    lastname VARCHAR(50),
    email VARCHAR(100),
    Departmentid INT,
    FOREIGN KEY (Departmentid) REFERENCES department(departmentID)
);

INSERT INTO instructors 
(InstructorsID, firstname, lastname, email, Departmentid) 
VALUES
(1,'Alice','Johnson','alice.johnson@univ.com',1),
(2,'Bob','Lee','bob.lee@univ.com',2);


CREATE TABLE Enrollments (
  Enrollmentid INT PRIMARY KEY,
  Studentid INT,
  Courseid INT,
  EnrollmentDate DATE,
  FOREIGN KEY (Studentid) REFERENCES student(studentID),
  FOREIGN KEY (Courseid) REFERENCES courses(courseid)
);

INSERT INTO Enrollments 
(Enrollmentid, Studentid, Courseid, EnrollmentDate)
VALUES
(1, 1, 101, '2022-08-01'),
(2, 2, 102, '2021-08-01');


Q1

INSERT INTO student 
VALUES (3,'Mike','Brown','mike@email.com','2001-07-10','2023-08-01');

SELECT * FROM student;

UPDATE student
SET email = 'john.new@email.com'
WHERE studentID = 1;

DELETE FROM student
WHERE studentID = 3;



Q3


SELECT c.*
FROM courses c
JOIN department d ON c.DepartmentID = d.departmentID
WHERE d.departmentname = 'Mathematics'
LIMIT 5;


Q4


SELECT Courseid, COUNT(Studentid) AS TotalStudents
FROM Enrollments
GROUP BY Courseid
HAVING COUNT(Studentid) > 5;


Q5


SELECT s.studentID, s.firstname, s.lastname
FROM student s
JOIN Enrollments e ON s.studentID = e.Studentid
JOIN courses c ON e.Courseid = c.courseid
WHERE c.coursename IN ('Introduction to SQL','Data Structures')
GROUP BY s.studentID, s.firstname, s.lastname
HAVING COUNT(DISTINCT c.coursename) = 2;


Q6


SELECT DISTINCT s.studentID, s.firstname, s.lastname
FROM student s
JOIN Enrollments e ON s.studentID = e.Studentid
JOIN courses c ON e.Courseid = c.courseid
WHERE c.coursename IN ('Introduction to SQL','Data Structures');


Q7


SELECT AVG(Credits) AS AverageCredits
FROM courses;


Q8

SELECT MAX(Salary) AS MaxSalary
FROM instructors i
JOIN department d ON i.Departmentid = d.departmentID
WHERE d.departmentname = 'Computer Science';


Q9


SELECT d.departmentname, COUNT(e.Studentid) AS TotalStudents
FROM department d
JOIN courses c ON d.departmentID = c.DepartmentID
JOIN Enrollments e ON c.courseid = e.Courseid
GROUP BY d.departmentname;


Q10

SELECT s.firstname, s.lastname, c.coursename
FROM student s
INNER JOIN Enrollments e ON s.studentID = e.Studentid
INNER JOIN courses c ON e.Courseid = c.courseid;


Q11


SELECT s.firstname, s.lastname, c.coursename
FROM student s
LEFT JOIN Enrollments e ON s.studentID = e.Studentid
LEFT JOIN courses c ON e.Courseid = c.courseid;


Q12


SELECT *
FROM student
WHERE studentID IN (
SELECT Studentid
FROM Enrollments
WHERE Courseid IN (
SELECT Courseid
FROM Enrollments
GROUP BY Courseid
HAVING COUNT(Studentid) > 10
)
);